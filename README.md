# -enetokuについて
コレはekotokuのやつです。

import cv2import pytesseractimport reimport jsonfrom datetime import datefrom openai import OpenAI# =====================# 設定# =====================IMAGE_PATH = "camera_image.jpg"DB_FILE = "water_data.json"client = OpenAI()# =====================# OCR：水道代を読み取る# =====================def read_water_bill(image_path):    img = cv2.imread(image_path)    if img is None:        return None    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)    text = pytesseract.image_to_string(gray, lang="jpn")    match = re.search(r'([0-9,]+)円', text)    if not match:        return None    return int(match.group(1).replace(",", ""))# =====================# データ保存（月別）# =====================def save_bill(amount):    month = date.today().strftime("%Y-%m")    try:        with open(DB_FILE, "r", encoding="utf-8") as f:            data = json.load(f)    except FileNotFoundError:        data = {}    data[month] = amount    with open(DB_FILE, "w", encoding="utf-8") as f:        json.dump(data, f, ensure_ascii=False, indent=2)    return data# =====================# OpenAI API：節約アドバイス生成# =====================def generate_advice(data):    history = "\n".join(        [f"{month}: {amount}円" for month, amount in data.items()]    )    prompt = f"""以下はユーザーの月別水道代です。{history}この情報をもとに、1. 使用傾向の分析2. 水道代が高くなっている可能性のある原因3. 今すぐ実践できる節水アドバイスを3つを、日本語でやさしく説明してください。"""    response = client.chat.completions.create(        model="gpt-4o-mini",        messages=[            {"role": "system", "content": "あなたは水道代節約に詳しい家計アドバイザーです。"},            {"role": "user", "content": prompt}        ],        temperature=0.6    )    return response.choices[0].message.content# =====================# メイン処理# =====================def main():    print(" 水道料金の画像を読み込み中...")    amount = read_water_bill(IMAGE_PATH)    if amount is None:        print(" 水道代を読み取れませんでした")        return    print(f" 今月の水道代: {amount}円")    data = save_bill(amount)    print(" AIが節約アドバイスを生成中...")    advice = generate_advice(data)    print("\n AI節約アドバイス")    print("================================")    print(advice)if __name__ == "__main__":    main()
